statement ok
SELECT * from wrenai.public."Orders"

statement ok
SELECT * from public."Orders"

statement ok
SELECT * from "Orders"

statement ok
select cast("Freight_value" as int) + cast("Price" as int) from wrenai.public."Order_items"

statement ok
select "Product_id" from wrenai.public."Order_items" where cast("Freight_value" as double) > 10.0

statement ok
select "Product_id" from wrenai.public."Order_items" where "Freight_value" > 10.0

statement ok
select "Product_id", min("Price") from wrenai.public."Order_items" group by "Product_id"

statement ok
select "Product_id", min("Price") from wrenai.public."Order_items" where "Freight_value" > 10.0 group by "Product_id"

statement ok
select * from wrenai.public."Order_items";

statement ok
select * from wrenai.public."Customers";

statement ok
select count(*) from wrenai.public."Order_items";

# check the count of order_items won't be increased by the relationship calculation
query B
select cnt1 = cnt2 from (select count(*) as cnt1 from (select "Customer_state" from wrenai.public."Order_items")), (select count(*) as cnt2 from datafusion.public.order_items) limit 1;
----
true

query I rowsort
WITH w1 as (select "Id" from "Order_items" where "Price" in
    (select distinct "Price" from "Order_items" order by "Price" DESC LIMIT 5))
select * from w1;
----
123
175
178
201
56
9

# TODO: occurred fatal runtime error: stack overflow
#query B
#select actual = expected from (select "Totalprice" as actual from wrenai.public."Orders" where "Order_id" = '76754c0e642c8f99a8c3fcb8a14ac700'), (select sum(price) as expected from datafusion.public.order_items where order_id = '76754c0e642c8f99a8c3fcb8a14ac700') limit 1;
#----
#true

query IR
select "Id", "Price" from "Order_items" where "Order_id" in (SELECT "Order_id" FROM "Orders" WHERE "Customer_id" = 'f6c39f83de772dd502809cee2fee4c41')
----
105 287.4

# TODO: DataFusion has some case sensitivity issue with the outer reference column name
# Test the query with outer reference column
# query I
# select "Customer_id" from wrenai.public."Orders" where not exists (select 1 from wrenai.public."Order_items" where "Orders"."Order_id" = "Order_items"."Order_id")
# ----
# 1
